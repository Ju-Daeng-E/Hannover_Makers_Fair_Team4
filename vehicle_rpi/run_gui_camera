#!/bin/bash

# GUI 카메라 뷰어 선택 스크립트
echo "🖥️ GUI 카메라 뷰어 선택"
echo "======================="

# X11 환경 확인
if [ -z "$DISPLAY" ]; then
    echo "❌ X11 DISPLAY가 설정되지 않았습니다"
    echo "💡 SSH 연결시: ssh -X 또는 ssh -Y 사용"
    echo "   예: ssh -X pi@team4.local"
    exit 1
else
    echo "✅ X11 DISPLAY: $DISPLAY"
fi

# SSH 환경 확인
if [ -n "$SSH_CLIENT" ]; then
    echo "🌐 SSH 원격 연결 감지됨"
fi

echo ""
echo "📋 사용 가능한 GUI 옵션:"
echo "1) Tkinter GUI    - 가장 안정적 (권장)"
echo "2) Matplotlib GUI - 중간 안정성"
echo "3) OpenCV GUI     - 고급 기능 (Qt 문제 가능)"
echo "4) 환경 테스트"
echo ""

read -p "선택하세요 (1-4): " choice

case $choice in
    1)
        echo "🚀 Tkinter GUI 실행..."
        echo "📋 조작법: 창에서 버튼 클릭, 키보드 's'=저장, 'q'=종료"
        python3 ./camera_tkinter_gui.py
        ;;
    2)
        echo "🚀 Matplotlib GUI 실행..."
        echo "📋 조작법: 'q'=종료, 's'=저장, 창 닫기=종료"
        python3 ./camera_matplotlib_gui.py
        ;;
    3)
        echo "🚀 OpenCV GUI 실행 (Qt 문제 가능)..."
        echo "💡 Qt 문제 발생시 1번 또는 2번 사용하세요"
        source ./fix_x11_ssh
        python3 ./camera_simple_gui.py
        ;;
    4)
        echo "🧪 X11 환경 테스트..."
        python3 ./test_x11.py
        ;;
    *)
        echo "❌ 잘못된 선택입니다"
        exit 1
        ;;
esac

echo ""
echo "✅ GUI 카메라 뷰어 종료됨"